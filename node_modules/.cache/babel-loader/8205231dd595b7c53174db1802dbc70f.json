{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\\\u05DE\\u05DC\\u05D0\\u05DA \\u05D2\\u05DC\\\\Desktop\\\\ShoppingProject\\\\client\\\\src\\\\components\\\\search\\\\Search.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react'; // Redux\n\nimport { useDispatch, useSelector } from 'react-redux';\nimport { setProductsState } from '../../store/actions'; // Components\n\nimport Poper from './poper/Poper'; // Material ui\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Button, InputBase, IconButton } from '@material-ui/core';\nimport SearchIcon from '@material-ui/icons/Search';\nimport ClearIcon from '@material-ui/icons/Clear'; // Dates\n\nimport 'date-fns';\nimport DateFnsUtils from '@date-io/date-fns';\nimport { MuiPickersUtilsProvider, KeyboardDatePicker } from '@material-ui/pickers'; // Css\n\nimport './style.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  search: {\n    display: 'flex',\n    position: 'relative',\n    borderRadius: theme.shape.borderRadius,\n    backgroundColor: 'whitesmoke',\n    marginRight: theme.spacing(2),\n    marginLeft: theme.spacing(2),\n    width: '348px !important',\n    // width: 'auto',\n    color: 'black',\n    margin: '10px 0px',\n    [theme.breakpoints.up('md')]: {\n      width: 'auto !important'\n    }\n  },\n  searchIcon: {\n    padding: theme.spacing(0, 2),\n    height: '100%',\n    position: 'absolute',\n    pointerEvents: 'none',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'right'\n  },\n  inputRoot: {\n    color: 'inherit',\n    fontSize: '13px'\n  },\n  inputInput: {\n    padding: theme.spacing(1, 1, 1, 0),\n    paddingLeft: `calc(1em + ${theme.spacing(4)}px)`,\n    transition: theme.transitions.create('width'),\n    width: '100%',\n    [theme.breakpoints.up('md')]: {\n      width: '20ch'\n    }\n  },\n  sortBtn: {\n    padding: '0px 8px 8px'\n  }\n}));\n\nconst Search = () => {\n  _s();\n\n  const [searchValue, setSearchValue] = useState('');\n  const [searchBy, setSearchBy] = useState('General');\n  const [anchorEl, setAnchorEl] = useState(null);\n  const [selectedStartDate, setSelectedStartDate] = useState(new Date());\n  const [selectedEndDate, setSelectedEndDate] = useState(new Date());\n  const user = JSON.parse(localStorage.getItem('user'));\n  const dispatch = useDispatch();\n  const vacations = useSelector(state => state.vacations.data);\n  const classes = useStyles();\n  const open = Boolean(anchorEl);\n\n  const handleClick = e => open ? setAnchorEl(null) : setAnchorEl(e.currentTarget);\n\n  const handleStartDateChange = date => setSelectedStartDate(date);\n\n  const handleEndDateChange = date => setSelectedEndDate(date);\n\n  const clearInput = () => {\n    setSearchValue('');\n\n    if (searchBy === 'Dates') {\n      setSelectedStartDate(new Date());\n      setSelectedEndDate(new Date());\n      bringAllVacation();\n    }\n  };\n\n  const bringAllVacation = async () => {\n    const res = await fetch(`https://vacationweb.herokuapp.com/vacation`);\n    const {\n      vacations\n    } = await res.json();\n    vacations.forEach(vacation => Boolean(vacation.Follows.find(follow => Number(follow.UserId) === Number(user.id))) ? vacation.isFollow = true : vacation.isFollow = false);\n    vacations.sort((x, y) => x.isFollow - y.isFollow).reverse();\n    dispatch(setProductsState(vacations));\n  };\n\n  const findVacations = async () => {\n    let value = '';\n    if (searchBy === 'Dates') value = {\n      startDate: selectedStartDate,\n      endDate: selectedEndDate\n    };else value = searchValue;\n    const searchObj = {\n      value,\n      type: searchBy\n    };\n    const res = await fetch(`https://vacationweb.herokuapp.com/vacation/search/${JSON.stringify(searchObj)}`);\n    const {\n      vacations\n    } = await res.json();\n    vacations.forEach(vacation => Boolean(vacation.Follows.find(follow => Number(follow.UserId) === Number(user.id))) ? vacation.isFollow = true : vacation.isFollow = false);\n    vacations.sort((x, y) => {\n      if (x.isFollow === y.isFollow) return 0;\n      if (x.isFollow) return -1;\n      if (y.isFollow) return 1;\n      return 0;\n    });\n    dispatch(setProductsState(vacations));\n  };\n\n  useEffect(() => {\n    if (searchBy === 'Dates') {\n      if (!(selectedStartDate.getDate() === new Date().getDate() && selectedStartDate.getMonth() === new Date().getMonth() && selectedEndDate.getDate() === new Date().getDate() && selectedEndDate.getMonth() === new Date().getMonth())) {\n        findVacations();\n      } else {\n        console.log('not searching');\n      }\n    } else {\n      findVacations();\n    }\n  }, [searchValue, searchBy, selectedStartDate, selectedEndDate]);\n  useEffect(() => {\n    setSearchValue('');\n  }, [searchBy]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.search,\n      id: \"stepFour\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.searchIcon,\n        children: searchBy !== 'Dates' ? /*#__PURE__*/_jsxDEV(SearchIcon, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 39\n        }, this) : null\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 13\n      }, this), searchBy === 'Dates' ? /*#__PURE__*/_jsxDEV(MuiPickersUtilsProvider, {\n        utils: DateFnsUtils,\n        children: [/*#__PURE__*/_jsxDEV(KeyboardDatePicker, {\n          label: \"start date\",\n          format: \"dd/MM/yyyy\",\n          value: selectedStartDate,\n          onChange: handleStartDateChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(KeyboardDatePicker, {\n          label: \"end date\",\n          format: \"dd/MM/yyyy\",\n          value: selectedEndDate,\n          onChange: handleEndDateChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(InputBase, {\n        type: \"text\",\n        value: searchValue,\n        onChange: e => setSearchValue(e.target.value),\n        placeholder: \"Search\\u2026\",\n        classes: {\n          root: classes.inputRoot,\n          input: classes.inputInput\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sort_btn_div\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"sort_span\",\n          children: \"search by\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          className: classes.sortBtn,\n          onClick: handleClick,\n          children: [\" \", searchBy, \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(IconButton, {\n        onClick: () => clearInput(),\n        children: [\" \", /*#__PURE__*/_jsxDEV(ClearIcon, {\n          fontSize: \"small\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 55\n        }, this), \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 12\n      }, this), /*#__PURE__*/_jsxDEV(Poper, {\n        vacations: vacations,\n        open: open,\n        anchorEl: anchorEl,\n        setAnchorEl: setAnchorEl,\n        setSearchBy: setSearchBy\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 12\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 12\n    }, this)\n  }, void 0, false);\n};\n\n_s(Search, \"XDf1gV41twVIU1y37x7izuae+EE=\", false, function () {\n  return [useDispatch, useSelector, useStyles];\n});\n\n_c = Search;\nexport default Search;\n\nvar _c;\n\n$RefreshReg$(_c, \"Search\");","map":{"version":3,"sources":["C:/Users/מלאך גל/Desktop/ShoppingProject/client/src/components/search/Search.js"],"names":["React","useState","useEffect","useDispatch","useSelector","setProductsState","Poper","makeStyles","Button","InputBase","IconButton","SearchIcon","ClearIcon","DateFnsUtils","MuiPickersUtilsProvider","KeyboardDatePicker","useStyles","theme","search","display","position","borderRadius","shape","backgroundColor","marginRight","spacing","marginLeft","width","color","margin","breakpoints","up","searchIcon","padding","height","pointerEvents","alignItems","justifyContent","inputRoot","fontSize","inputInput","paddingLeft","transition","transitions","create","sortBtn","Search","searchValue","setSearchValue","searchBy","setSearchBy","anchorEl","setAnchorEl","selectedStartDate","setSelectedStartDate","Date","selectedEndDate","setSelectedEndDate","user","JSON","parse","localStorage","getItem","dispatch","vacations","state","data","classes","open","Boolean","handleClick","e","currentTarget","handleStartDateChange","date","handleEndDateChange","clearInput","bringAllVacation","res","fetch","json","forEach","vacation","Follows","find","follow","Number","UserId","id","isFollow","sort","x","y","reverse","findVacations","value","startDate","endDate","searchObj","type","stringify","getDate","getMonth","console","log","target","root","input"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\n// Redux\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { setProductsState } from '../../store/actions'\r\n// Components\r\nimport Poper from './poper/Poper'\r\n// Material ui\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport { Button, InputBase, IconButton } from '@material-ui/core'\r\nimport SearchIcon from '@material-ui/icons/Search'\r\nimport ClearIcon from '@material-ui/icons/Clear'\r\n// Dates\r\nimport 'date-fns';\r\nimport DateFnsUtils from '@date-io/date-fns'\r\nimport { MuiPickersUtilsProvider, KeyboardDatePicker } from '@material-ui/pickers'\r\n// Css\r\nimport './style.css'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    search: {\r\n      display: 'flex',\r\n      position: 'relative',\r\n      borderRadius: theme.shape.borderRadius,\r\n      backgroundColor: 'whitesmoke',\r\n      marginRight: theme.spacing(2),\r\n      marginLeft: theme.spacing(2),\r\n      width: '348px !important',\r\n      // width: 'auto',\r\n      color:'black',\r\n      margin: '10px 0px',\r\n      [theme.breakpoints.up('md')]: {\r\n        width: 'auto !important',\r\n      },\r\n    },\r\n    searchIcon: {\r\n      padding: theme.spacing(0, 2),\r\n      height: '100%',\r\n      position: 'absolute',\r\n      pointerEvents: 'none',\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      justifyContent: 'right',\r\n    },\r\n    inputRoot: {\r\n      color: 'inherit',\r\n      fontSize: '13px'\r\n    },\r\n    inputInput: {\r\n      padding: theme.spacing(1, 1, 1, 0),\r\n      paddingLeft: `calc(1em + ${theme.spacing(4)}px)`,\r\n      transition: theme.transitions.create('width'),\r\n      width: '100%',\r\n      [theme.breakpoints.up('md')]: {\r\n        width: '20ch',\r\n      },\r\n    },\r\n    sortBtn: {\r\n      padding:'0px 8px 8px'\r\n    }\r\n   \r\n    \r\n  }))\r\n\r\nconst Search = () => {\r\n    const [searchValue, setSearchValue] = useState('')\r\n    const [searchBy, setSearchBy] = useState('General')\r\n    const [anchorEl, setAnchorEl] = useState(null)\r\n    const [selectedStartDate, setSelectedStartDate] = useState(new Date())\r\n    const [selectedEndDate, setSelectedEndDate] = useState(new Date())\r\n    const user = JSON.parse(localStorage.getItem('user'))\r\n    const dispatch = useDispatch()\r\n    const vacations = useSelector(state => state.vacations.data)\r\n    const classes = useStyles()\r\n    const open = Boolean(anchorEl)\r\n  \r\n    const handleClick = (e) => open ? setAnchorEl(null) : setAnchorEl(e.currentTarget)\r\n    const handleStartDateChange = (date) => setSelectedStartDate(date)\r\n    const handleEndDateChange = (date) => setSelectedEndDate(date)\r\n    const clearInput = () => {\r\n      setSearchValue('')\r\n      if(searchBy === 'Dates') {\r\n        setSelectedStartDate(new Date())\r\n        setSelectedEndDate(new Date())\r\n        bringAllVacation()\r\n    }\r\n  }\r\n\r\n    const bringAllVacation = async () => {\r\n      const res = await fetch(`https://vacationweb.herokuapp.com/vacation`)\r\n      const { vacations } = await res.json()\r\n      vacations.forEach(vacation => Boolean(vacation.Follows.find(follow => Number(follow.UserId) === Number(user.id))) ? vacation.isFollow = true : vacation.isFollow = false)\r\n      vacations.sort((x, y) =>  x.isFollow - y.isFollow).reverse()\r\n      dispatch(setProductsState(vacations))\r\n    }\r\n\r\n    const findVacations = async () => {\r\n      let value = ''\r\n      if(searchBy === 'Dates') value = { startDate:selectedStartDate, endDate: selectedEndDate }\r\n      else value = searchValue\r\n      const searchObj = { value, type:searchBy }\r\n      const res = await fetch(`https://vacationweb.herokuapp.com/vacation/search/${JSON.stringify(searchObj)}`)\r\n      const { vacations } = await res.json()\r\n      vacations.forEach(vacation => Boolean(vacation.Follows.find(follow => Number(follow.UserId) === Number(user.id))) ? vacation.isFollow = true : vacation.isFollow = false)\r\n      vacations.sort((x, y) => {\r\n        if (x.isFollow === y.isFollow) return 0\r\n        if (x.isFollow)  return -1\r\n        if (y.isFollow) return 1\r\n        return 0\r\n      })\r\n      dispatch(setProductsState(vacations))\r\n    }\r\n \r\n    useEffect(() => {\r\n      if(searchBy === 'Dates') {\r\n        if(!(\r\n          (selectedStartDate.getDate() === new Date().getDate() && selectedStartDate.getMonth() === new Date().getMonth())\r\n           && (selectedEndDate.getDate() === new Date().getDate() && selectedEndDate.getMonth() === new Date().getMonth()))){\r\n          findVacations()\r\n        } else {\r\n          console.log('not searching');\r\n        }\r\n      } else {\r\n        findVacations()\r\n      }\r\n    }, [searchValue, searchBy, selectedStartDate, selectedEndDate])\r\n\r\n    useEffect(() => {\r\n      setSearchValue('')\r\n    },[searchBy])\r\n\r\n    return (\r\n        <>\r\n\r\n           <div className={classes.search} id='stepFour'>\r\n            <div className={classes.searchIcon}>\r\n             { searchBy !== 'Dates' ? <SearchIcon/> : null }\r\n            </div>\r\n            {searchBy === 'Dates' ? \r\n            <MuiPickersUtilsProvider utils={DateFnsUtils}>\r\n              <KeyboardDatePicker\r\n                label=\"start date\"\r\n                format=\"dd/MM/yyyy\"\r\n                value={selectedStartDate}\r\n                onChange={handleStartDateChange}\r\n              />\r\n              <KeyboardDatePicker\r\n              label=\"end date\"\r\n            \r\n                format=\"dd/MM/yyyy\"\r\n                value={selectedEndDate}\r\n                onChange={handleEndDateChange}\r\n              />\r\n          </MuiPickersUtilsProvider>\r\n         :\r\n         \r\n            <InputBase\r\n              type='text'\r\n              value={searchValue}\r\n              onChange={e =>  setSearchValue(e.target.value)}\r\n              placeholder=\"Search…\"\r\n              classes={{\r\n                root: classes.inputRoot,\r\n                input: classes.inputInput,\r\n              }}\r\n            />\r\n            }\r\n            <div className=\"sort_btn_div\">\r\n              <span className=\"sort_span\">search by</span>\r\n              <Button className={classes.sortBtn} onClick={handleClick}> {searchBy} </Button> \r\n            </div>\r\n           <IconButton onClick={() => clearInput() }> <ClearIcon fontSize=\"small\"/> </IconButton> \r\n           <Poper vacations={vacations} open={open} anchorEl={anchorEl} setAnchorEl={setAnchorEl} setSearchBy={setSearchBy} />\r\n          </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default Search\r\n"]},"metadata":{},"sourceType":"module"}