{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\\\u05DE\\u05DC\\u05D0\\u05DA \\u05D2\\u05DC\\\\Desktop\\\\ShoppingProject\\\\client\\\\src\\\\components\\\\productCard\\\\ProductCard.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react'; // Redux\n\nimport { useDispatch, useSelector } from 'react-redux';\nimport { setProductToUpdate, setCartProducts, addCartProducts, updateTotalPrice, setProductsState, setDrawerState } from '../../store/actions'; // Material ui\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport RemoveIcon from '@material-ui/icons/Remove';\nimport AddIcon from '@material-ui/icons/Add'; // React toastify \n\nimport { toast, Zoom } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css'; // Cloudinary\n\nimport { Image } from 'cloudinary-react'; // Css\n\nimport './style.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(() => ({\n  icon: {\n    cursor: 'pointer',\n    margin: '0px 5px',\n    \"&:hover\": {\n      backgroundColor: '#F5F3F3',\n      borderRadius: '100px'\n    }\n  }\n}));\n\nconst ProductCard = ({\n  product\n}) => {\n  _s();\n\n  const cart = JSON.parse(localStorage.getItem('availableCart'));\n  const products = useSelector(state => state.products.data);\n  const cartProducts = useSelector(state => state.products.cartProducts);\n  const isAdmin = useSelector(state => state.users.isAdmin);\n  const classes = useStyles();\n  const dispatch = useDispatch(); // Toastify\n\n  const successToast = message => {\n    toast(message, {\n      draggable: true,\n      position: toast.POSITION.BOTTOM_RIGHT,\n      transition: Zoom,\n      autoClose: 2000\n    });\n  }; // Add product to cart or update excisting one\n\n\n  const addToCart = async (id, amount, price) => {\n    const response = await fetch('/cart_item', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        amount,\n        price: price * amount,\n        ProductId: id,\n        CartId: cart.id\n      })\n    });\n    const {\n      cartItem\n    } = await response.json();\n    console.log(cartItem);\n\n    if (cartItem) {\n      const cartItemsArr = cartProducts;\n      const changedItem = cartItemsArr.find(item => item.id === cartItem.ProductId);\n\n      if (changedItem) {\n        dispatch(updateTotalPrice((amount - changedItem.amount) * price));\n        changedItem.amount = amount;\n        changedItem.totalPrice = price * amount;\n        dispatch(setCartProducts(cartItemsArr));\n        successToast('Product updated in cart! ðŸ˜€');\n      } else {\n        const newProductInCart = {\n          id: cartItem.ProductId,\n          name: cartItem.Product.name,\n          singlePrice: cartItem.Product.price,\n          amount: cartItem.amount,\n          totalPrice: cartItem.price,\n          image: cartItem.Product.image\n        };\n        const productArr = products;\n        const addedProduct = productArr.find(item => item.id === id);\n        addedProduct.isInCart = true;\n        dispatch(setProductsState(productArr));\n        dispatch(addCartProducts(newProductInCart));\n        dispatch(updateTotalPrice(newProductInCart.totalPrice));\n        successToast('Product added to cart! ðŸ˜€');\n      }\n    }\n  }; // Reduce the quantity of product\n\n\n  const reduceQuantity = id => {\n    const productsArr = products;\n    const product = productsArr.find(product => product.id === id);\n    product.quantity -= 1;\n    dispatch(setProductsState(productsArr));\n  }; // Add to the quantity of product\n\n\n  const addQuantity = id => {\n    const productsArr = products;\n    const product = productsArr.find(product => product.id === id);\n    product.quantity += 1;\n    dispatch(setProductsState(productsArr));\n  }; // Admin functions\n  // Update product details\n\n\n  const updateProduct = id => {\n    const productToUpdate = products.find(product => product.id === id);\n    dispatch(setProductToUpdate(productToUpdate));\n    dispatch(setDrawerState(true));\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: product.image && /*#__PURE__*/_jsxDEV(\"div\", {\n      class: \"contain\",\n      children: [/*#__PURE__*/_jsxDEV(Image, {\n        cloudName: \"malachcloud\",\n        src: product.image,\n        width: \"250\",\n        height: \"200\",\n        crop: \"scale\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: product.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"properties\",\n        children: [!isAdmin && /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"qty\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"Quantity\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(RemoveIcon, {\n            className: classes.icon,\n            fontSize: \"small\",\n            color: \"action\",\n            onClick: () => reduceQuantity(product.id)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            class: \"number\",\n            children: product.quantity\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(AddIcon, {\n            className: classes.icon,\n            fontSize: \"small\",\n            color: \"action\",\n            onClick: () => addQuantity(product.id),\n            id: \"stepTwo\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"price\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"Price\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            class: \"price-inr\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              class: \"fa fa-inr\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              class: \"amount\",\n              children: [\"$\", product.price]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 130,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 13\n        }, this), !isAdmin && /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"price\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"Total\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            class: \"price-inr\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              class: \"fa fa-inr\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 138,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              class: \"amount\",\n              children: [\"$\", +product.price * +product.quantity]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 139,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }, this), !isAdmin && /*#__PURE__*/_jsxDEV(\"input\", {\n        class: \"ip-add-cart\",\n        type: \"button\",\n        value: product.isInCart ? 'Update' : 'Add to cart',\n        onClick: () => addToCart(product.id, product.quantity, product.price),\n        id: \"stepOne\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 20\n      }, this), isAdmin && /*#__PURE__*/_jsxDEV(\"input\", {\n        class: \"ip-add-cart\",\n        type: \"button\",\n        value: \"Update product\",\n        onClick: () => updateProduct(product.id)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 19\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n};\n\n_s(ProductCard, \"w90FA5dy+gKPdXrnnXdLvkxnzFk=\", false, function () {\n  return [useSelector, useSelector, useSelector, useStyles, useDispatch];\n});\n\n_c = ProductCard;\nexport default ProductCard;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProductCard\");","map":{"version":3,"sources":["C:/Users/×ž×œ××š ×’×œ/Desktop/ShoppingProject/client/src/components/productCard/ProductCard.js"],"names":["React","useDispatch","useSelector","setProductToUpdate","setCartProducts","addCartProducts","updateTotalPrice","setProductsState","setDrawerState","makeStyles","RemoveIcon","AddIcon","toast","Zoom","Image","useStyles","icon","cursor","margin","backgroundColor","borderRadius","ProductCard","product","cart","JSON","parse","localStorage","getItem","products","state","data","cartProducts","isAdmin","users","classes","dispatch","successToast","message","draggable","position","POSITION","BOTTOM_RIGHT","transition","autoClose","addToCart","id","amount","price","response","fetch","method","headers","body","stringify","ProductId","CartId","cartItem","json","console","log","cartItemsArr","changedItem","find","item","totalPrice","newProductInCart","name","Product","singlePrice","image","productArr","addedProduct","isInCart","reduceQuantity","productsArr","quantity","addQuantity","updateProduct","productToUpdate"],"mappings":"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","sourcesContent":["import React from 'react'\r\n// Redux\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { setProductToUpdate, setCartProducts, addCartProducts, updateTotalPrice, setProductsState, setDrawerState } from '../../store/actions'\r\n// Material ui\r\nimport { makeStyles } from '@material-ui/core/styles'  \r\nimport RemoveIcon from '@material-ui/icons/Remove';\r\nimport AddIcon from '@material-ui/icons/Add';\r\n// React toastify \r\nimport { toast, Zoom } from 'react-toastify'\r\nimport 'react-toastify/dist/ReactToastify.css'\r\n// Cloudinary\r\nimport { Image } from 'cloudinary-react'\r\n// Css\r\nimport './style.css'\r\n\r\nconst useStyles = makeStyles(() => ({\r\n    icon: {\r\n      cursor:'pointer',\r\n      margin:'0px 5px',\r\n       \"&:hover\": {\r\n        backgroundColor: '#F5F3F3',\r\n        borderRadius:'100px',\r\n      }\r\n    }\r\n  }))     \r\n  \r\nconst ProductCard = ({ product }) => {\r\n    const cart = JSON.parse(localStorage.getItem('availableCart'))\r\n    const products = useSelector(state => state.products.data)\r\n    const cartProducts = useSelector(state => state.products.cartProducts)\r\n    const isAdmin = useSelector(state => state.users.isAdmin)\r\n    const classes = useStyles()\r\n    const dispatch = useDispatch()\r\n\r\n    // Toastify\r\n    const successToast = (message) => {\r\n     toast(message, { \r\n      draggable: true, \r\n      position: toast.POSITION.BOTTOM_RIGHT,\r\n      transition: Zoom,\r\n      autoClose: 2000\r\n      })\r\n    }\r\n\r\n    // Add product to cart or update excisting one\r\n    const addToCart = async (id, amount, price) => {\r\n      const response = await fetch('/cart_item', { \r\n        method: 'POST',\r\n        headers: {\r\n         'Content-Type':'application/json'\r\n       },\r\n       body: JSON.stringify({ amount, price: price * amount, ProductId: id, CartId: cart.id })\r\n       })\r\n       const { cartItem } = await response.json() \r\n       console.log(cartItem)\r\n       if(cartItem) {\r\n        const cartItemsArr = cartProducts\r\n        const changedItem = cartItemsArr.find(item => item.id === cartItem.ProductId)\r\n        if(changedItem) {\r\n          dispatch(updateTotalPrice( (amount - changedItem.amount ) * price ))\r\n          changedItem.amount = amount\r\n          changedItem.totalPrice = price * amount\r\n          dispatch(setCartProducts(cartItemsArr))\r\n          successToast('Product updated in cart! ðŸ˜€')\r\n        } else {\r\n         const newProductInCart = { \r\n           id: cartItem.ProductId,\r\n           name: cartItem.Product.name,\r\n           singlePrice: cartItem.Product.price,\r\n           amount: cartItem.amount,\r\n           totalPrice:cartItem.price,\r\n           image: cartItem.Product.image\r\n         }\r\n          const productArr = products\r\n          const addedProduct = productArr.find(item => item.id === id)\r\n          addedProduct.isInCart = true\r\n          dispatch(setProductsState(productArr))\r\n          dispatch(addCartProducts(newProductInCart))\r\n          dispatch(updateTotalPrice(newProductInCart.totalPrice))\r\n          successToast('Product added to cart! ðŸ˜€')\r\n        }\r\n       }\r\n    }\r\n\r\n    // Reduce the quantity of product\r\n    const reduceQuantity = (id) => {\r\n      const productsArr = products\r\n      const product = productsArr.find(product => product.id === id)\r\n      product.quantity -= 1\r\n      dispatch(setProductsState(productsArr))\r\n    }\r\n  \r\n    // Add to the quantity of product\r\n    const addQuantity = (id) => {\r\n      const productsArr = products\r\n      const product = productsArr.find(product => product.id === id)\r\n      product.quantity += 1\r\n      dispatch(setProductsState(productsArr))\r\n    }\r\n\r\n    // Admin functions\r\n\r\n    // Update product details\r\n    const updateProduct = (id) => {\r\n      const productToUpdate = products.find(product => product.id === id)\r\n      dispatch(setProductToUpdate(productToUpdate))\r\n      dispatch(setDrawerState(true))\r\n    }\r\n\r\n    return (\r\n      <>\r\n      {product.image &&\r\n      <div class=\"contain\">\r\n        <Image cloudName=\"malachcloud\" src={product.image} width=\"250\" height=\"200\" crop=\"scale\" />\r\n        <h3>{product.name}</h3>\r\n        <div class=\"properties\">\r\n          {!isAdmin &&\r\n            <div class=\"qty\">\r\n              <h4 >Quantity</h4>\r\n              <RemoveIcon className={classes.icon} fontSize=\"small\" color=\"action\"   onClick={() => reduceQuantity(product.id)} /> \r\n              <span class=\"number\">{product.quantity}</span>\r\n              <AddIcon className={classes.icon} fontSize=\"small\" color=\"action\"  onClick={() => addQuantity(product.id)} id=\"stepTwo\"/>\r\n            </div> }\r\n\r\n            <div class=\"price\">\r\n              <h4>Price</h4>\r\n              <span class=\"price-inr\">\r\n                <i class=\"fa fa-inr\"></i>\r\n                <span class=\"amount\">${product.price}</span>\r\n              </span>\r\n            </div>\r\n\r\n            {!isAdmin &&\r\n            <div class=\"price\">\r\n              <h4>Total</h4>\r\n              <span class=\"price-inr\">\r\n                <i class=\"fa fa-inr\"></i>\r\n                <span class=\"amount\">${+product.price * +product.quantity}</span>\r\n              </span>\r\n            </div> }\r\n        </div>\r\n    \r\n      {!isAdmin && <input class=\"ip-add-cart\" type=\"button\" value={product.isInCart ? 'Update' : 'Add to cart'} onClick={() => addToCart(product.id, product.quantity, product.price )}  id=\"stepOne\"/> }\r\n      {isAdmin && <input class=\"ip-add-cart\" type=\"button\" value=\"Update product\" onClick={() => updateProduct(product.id)} /> }\r\n    </div> }\t\r\n   </>\r\n    )\r\n}\r\n\r\nexport default ProductCard\r\n"]},"metadata":{},"sourceType":"module"}